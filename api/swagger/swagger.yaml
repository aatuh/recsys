basePath: /
definitions:
  common.APIError:
    properties:
      correlation_id:
        type: string
      details:
        additionalProperties: {}
        type: object
      error:
        type: string
      message:
        type: string
    type: object
  internal_http_types.ScoredItem:
    properties:
      item_id:
        example: i_101
        type: string
      reasons:
        items:
          type: string
        type: array
      score:
        example: 0.87
        type: number
    type: object
  types.Ack:
    properties:
      status:
        type: string
    type: object
  types.BanditDecideRequest:
    properties:
      algorithm:
        type: string
      candidate_policy_ids:
        items:
          type: string
        type: array
      context:
        additionalProperties:
          type: string
        type: object
      namespace:
        type: string
      request_id:
        type: string
      surface:
        type: string
    type: object
  types.BanditDecideResponse:
    properties:
      algorithm:
        type: string
      bucket_key:
        type: string
      explain:
        additionalProperties:
          type: string
        type: object
      explore:
        type: boolean
      policy_id:
        type: string
      surface:
        type: string
    type: object
  types.BanditPoliciesUpsertRequest:
    properties:
      namespace:
        type: string
      policies:
        items:
          $ref: '#/definitions/types.BanditPolicy'
        type: array
    type: object
  types.BanditPolicy:
    properties:
      active:
        type: boolean
      blend_alpha:
        type: number
      blend_beta:
        type: number
      blend_gamma:
        type: number
      brand_cap:
        type: integer
      category_cap:
        type: integer
      mmr_lambda:
        type: number
      name:
        type: string
      notes:
        type: string
      policy_id:
        type: string
    type: object
  types.BanditRewardRequest:
    properties:
      algorithm:
        type: string
      bucket_key:
        type: string
      namespace:
        type: string
      policy_id:
        type: string
      request_id:
        type: string
      reward:
        type: boolean
      surface:
        type: string
    type: object
  types.DeleteRequest:
    properties:
      created_after:
        description: Date range filters
        example: "2025-01-01T00:00:00Z"
        type: string
      created_before:
        example: "2025-12-31T23:59:59Z"
        type: string
      event_type:
        example: 0
        type: integer
      item_id:
        example: i_123
        type: string
      namespace:
        example: default
        type: string
      user_id:
        description: Optional filters - if not provided, deletes all data in namespace
        example: u_123
        type: string
    type: object
  types.DeleteResponse:
    properties:
      deleted_count:
        type: integer
      message:
        type: string
    type: object
  types.Event:
    properties:
      item_id:
        example: i_123
        type: string
      meta: {}
      source_event_id:
        type: string
      ts:
        example: "2025-09-07T12:34:56Z"
        type: string
      type:
        description: 0=view,1=click,2=add,3=purchase,4=custom
        example: 0
        type: integer
      user_id:
        example: u_123
        type: string
      value:
        example: 1
        type: number
    type: object
  types.EventTypeConfig:
    properties:
      half_life_days:
        type: number
      is_active:
        type: boolean
      name:
        type: string
      type:
        type: integer
      weight:
        type: number
    type: object
  types.EventTypeConfigUpsertRequest:
    properties:
      namespace:
        type: string
      types:
        items:
          $ref: '#/definitions/types.EventTypeConfig'
        type: array
    type: object
  types.EventTypeConfigUpsertResponse:
    properties:
      half_life_days:
        type: number
      is_active:
        type: boolean
      name:
        type: string
      source:
        description: '"tenant" or "default"'
        type: string
      type:
        type: integer
      weight:
        type: number
    type: object
  types.EventsBatchRequest:
    properties:
      events:
        items:
          $ref: '#/definitions/types.Event'
        type: array
      namespace:
        example: default
        type: string
    type: object
  types.Item:
    properties:
      available:
        example: true
        type: boolean
      embedding:
        items:
          type: number
        type: array
      item_id:
        example: i_123
        type: string
      price:
        example: 19.9
        type: number
      props: {}
      tags:
        items:
          type: string
        type: array
    type: object
  types.ItemsUpsertRequest:
    properties:
      items:
        items:
          $ref: '#/definitions/types.Item'
        type: array
      namespace:
        example: default
        type: string
    type: object
  types.ListResponse:
    properties:
      has_more:
        type: boolean
      items:
        items: {}
        type: array
      limit:
        type: integer
      next_offset:
        type: integer
      offset:
        type: integer
      total:
        type: integer
    type: object
  types.RecommendBlend:
    properties:
      als:
        example: 0
        type: number
      cooc:
        example: 0.7
        type: number
      pop:
        example: 0.3
        type: number
    type: object
  types.RecommendConstraints:
    properties:
      created_after:
        description: Optional ISO8601 timestamp; only consider events on/after this
          instant.
        example: "2025-06-01T00:00:00Z"
        type: string
      exclude_item_ids:
        description: Exclude these item IDs from results.
        items:
          type: string
        type: array
      include_tags_any:
        description: Match if item.tags overlaps these (any). Empty/omitted = no tag
          filter.
        items:
          type: string
        type: array
      price_between:
        description: 'Optional price bounds: [min, max]. Either end may be omitted.'
        items:
          type: number
        type: array
    type: object
  types.RecommendRequest:
    properties:
      blend:
        $ref: '#/definitions/types.RecommendBlend'
      constraints:
        $ref: '#/definitions/types.RecommendConstraints'
      include_reasons:
        example: true
        type: boolean
      k:
        example: 20
        type: integer
      namespace:
        example: default
        type: string
      user_id:
        example: u_123
        type: string
    type: object
  types.RecommendResponse:
    properties:
      items:
        items:
          $ref: '#/definitions/internal_http_types.ScoredItem'
        type: array
      model_version:
        example: pop_2025-09-07_01
        type: string
    type: object
  types.RecommendWithBanditRequest:
    properties:
      algorithm:
        type: string
      blend:
        $ref: '#/definitions/types.RecommendBlend'
      candidate_policy_ids:
        items:
          type: string
        type: array
      constraints:
        $ref: '#/definitions/types.RecommendConstraints'
      context:
        additionalProperties:
          type: string
        type: object
      include_reasons:
        example: true
        type: boolean
      k:
        example: 20
        type: integer
      namespace:
        example: default
        type: string
      surface:
        type: string
      user_id:
        example: u_123
        type: string
    type: object
  types.RecommendWithBanditResponse:
    properties:
      algorithm:
        type: string
      bandit_bucket:
        type: string
      bandit_explain:
        additionalProperties:
          type: string
        type: object
      chosen_policy_id:
        type: string
      explore:
        type: boolean
      items:
        items:
          $ref: '#/definitions/internal_http_types.ScoredItem'
        type: array
      model_version:
        example: pop_2025-09-07_01
        type: string
    type: object
  types.User:
    properties:
      traits: {}
      user_id:
        example: u_123
        type: string
    type: object
  types.UsersUpsertRequest:
    properties:
      namespace:
        example: default
        type: string
      users:
        items:
          $ref: '#/definitions/types.User'
        type: array
    type: object
host: localhost:8000
info:
  contact: {}
  description: Domain-agnostic recommendation service.
  title: Recsys API
  version: 0.0.1
paths:
  /v1/bandit/decide:
    post:
      consumes:
      - application/json
      parameters:
      - description: Decision request
        in: body
        name: payload
        required: true
        schema:
          $ref: '#/definitions/types.BanditDecideRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/types.BanditDecideResponse'
      summary: Decide best policy for this request context
      tags:
      - bandit
  /v1/bandit/policies:
    get:
      parameters:
      - description: Namespace
        in: query
        name: namespace
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/types.BanditPolicy'
            type: array
      summary: List active bandit policies
      tags:
      - bandit
  /v1/bandit/policies:upsert:
    post:
      consumes:
      - application/json
      operationId: upsertBanditPolicies
      parameters:
      - description: Policies
        in: body
        name: payload
        required: true
        schema:
          $ref: '#/definitions/types.BanditPoliciesUpsertRequest'
      produces:
      - application/json
      responses:
        "202":
          description: Accepted
          schema:
            $ref: '#/definitions/types.Ack'
      summary: Upsert bandit policies
      tags:
      - bandit
  /v1/bandit/recommendations:
    post:
      consumes:
      - application/json
      parameters:
      - description: Request
        in: body
        name: payload
        required: true
        schema:
          $ref: '#/definitions/types.RecommendWithBanditRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/types.RecommendWithBanditResponse'
      summary: Recommend with bandit-selected policy
      tags:
      - ranking
  /v1/bandit/reward:
    post:
      consumes:
      - application/json
      parameters:
      - description: Reward request
        in: body
        name: payload
        required: true
        schema:
          $ref: '#/definitions/types.BanditRewardRequest'
      produces:
      - application/json
      responses:
        "202":
          description: Accepted
          schema:
            $ref: '#/definitions/types.Ack'
      summary: Report binary reward for a previous decision
      tags:
      - bandit
  /v1/event-types:
    get:
      parameters:
      - description: Namespace
        in: query
        name: namespace
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/types.EventTypeConfigUpsertResponse'
            type: array
      summary: List effective event-type config
      tags:
      - config
  /v1/event-types:upsert:
    post:
      consumes:
      - application/json
      operationId: upsertEventTypes
      parameters:
      - description: Event types
        in: body
        name: payload
        required: true
        schema:
          $ref: '#/definitions/types.EventTypeConfigUpsertRequest'
      produces:
      - application/json
      responses:
        "202":
          description: Accepted
          schema:
            $ref: '#/definitions/types.Ack'
      summary: Upsert tenant event-type config
      tags:
      - config
  /v1/events:
    get:
      consumes:
      - application/json
      description: Get a paginated list of events with optional filtering by user_id,
        item_id, event_type, date range, etc.
      operationId: listEvents
      parameters:
      - description: Namespace
        in: query
        name: namespace
        required: true
        type: string
      - description: 'Limit (default: 100, max: 1000)'
        in: query
        name: limit
        type: integer
      - description: 'Offset (default: 0)'
        in: query
        name: offset
        type: integer
      - description: Filter by user ID
        in: query
        name: user_id
        type: string
      - description: Filter by item ID
        in: query
        name: item_id
        type: string
      - description: Filter by event type
        in: query
        name: event_type
        type: integer
      - description: Filter by creation date (ISO8601)
        in: query
        name: created_after
        type: string
      - description: Filter by creation date (ISO8601)
        in: query
        name: created_before
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/types.ListResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/common.APIError'
      summary: List events with pagination and filtering
      tags:
      - data-management
  /v1/events:batch:
    post:
      consumes:
      - application/json
      operationId: batchEvents
      parameters:
      - description: Events batch
        in: body
        name: payload
        required: true
        schema:
          $ref: '#/definitions/types.EventsBatchRequest'
      produces:
      - application/json
      responses:
        "202":
          description: Accepted
          schema:
            $ref: '#/definitions/types.Ack'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/common.APIError'
      summary: Ingest events (batch)
      tags:
      - ingestion
  /v1/events:delete:
    post:
      consumes:
      - application/json
      description: Delete events based on filters. If no filters provided, deletes
        all events in namespace.
      operationId: deleteEvents
      parameters:
      - description: Delete request
        in: body
        name: payload
        required: true
        schema:
          $ref: '#/definitions/types.DeleteRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/types.DeleteResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/common.APIError'
      summary: Delete events with optional filtering
      tags:
      - data-management
  /v1/items:
    get:
      consumes:
      - application/json
      description: Get a paginated list of items with optional filtering by item_id,
        date range, etc.
      operationId: listItems
      parameters:
      - description: Namespace
        in: query
        name: namespace
        required: true
        type: string
      - description: 'Limit (default: 100, max: 1000)'
        in: query
        name: limit
        type: integer
      - description: 'Offset (default: 0)'
        in: query
        name: offset
        type: integer
      - description: Filter by item ID
        in: query
        name: item_id
        type: string
      - description: Filter by creation date (ISO8601)
        in: query
        name: created_after
        type: string
      - description: Filter by creation date (ISO8601)
        in: query
        name: created_before
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/types.ListResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/common.APIError'
      summary: List items with pagination and filtering
      tags:
      - data-management
  /v1/items/{item_id}/similar:
    get:
      parameters:
      - description: Item ID
        in: path
        name: item_id
        required: true
        type: string
      - default: default
        description: Namespace
        in: query
        name: namespace
        type: string
      - default: 20
        description: Top-K
        in: query
        name: k
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/internal_http_types.ScoredItem'
            type: array
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/common.APIError'
      summary: Get similar items
      tags:
      - ranking
  /v1/items:delete:
    post:
      consumes:
      - application/json
      description: Delete items based on filters. If no filters provided, deletes
        all items in namespace.
      operationId: deleteItems
      parameters:
      - description: Delete request
        in: body
        name: payload
        required: true
        schema:
          $ref: '#/definitions/types.DeleteRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/types.DeleteResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/common.APIError'
      summary: Delete items with optional filtering
      tags:
      - data-management
  /v1/items:upsert:
    post:
      consumes:
      - application/json
      description: Create or update items by opaque IDs.
      operationId: upsertItems
      parameters:
      - description: Items upsert
        in: body
        name: payload
        required: true
        schema:
          $ref: '#/definitions/types.ItemsUpsertRequest'
      produces:
      - application/json
      responses:
        "202":
          description: Accepted
          schema:
            $ref: '#/definitions/types.Ack'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/common.APIError'
      summary: Upsert items (batch)
      tags:
      - ingestion
  /v1/recommendations:
    post:
      consumes:
      - application/json
      parameters:
      - description: Recommend request
        in: body
        name: payload
        required: true
        schema:
          $ref: '#/definitions/types.RecommendRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/types.RecommendResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/common.APIError'
      summary: Get recommendations for a user
      tags:
      - ranking
  /v1/users:
    get:
      consumes:
      - application/json
      description: Get a paginated list of users with optional filtering by user_id,
        date range, etc.
      operationId: listUsers
      parameters:
      - description: Namespace
        in: query
        name: namespace
        required: true
        type: string
      - description: 'Limit (default: 100, max: 1000)'
        in: query
        name: limit
        type: integer
      - description: 'Offset (default: 0)'
        in: query
        name: offset
        type: integer
      - description: Filter by user ID
        in: query
        name: user_id
        type: string
      - description: Filter by creation date (ISO8601)
        in: query
        name: created_after
        type: string
      - description: Filter by creation date (ISO8601)
        in: query
        name: created_before
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/types.ListResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/common.APIError'
      summary: List users with pagination and filtering
      tags:
      - data-management
  /v1/users:delete:
    post:
      consumes:
      - application/json
      description: Delete users based on filters. If no filters provided, deletes
        all users in namespace.
      operationId: deleteUsers
      parameters:
      - description: Delete request
        in: body
        name: payload
        required: true
        schema:
          $ref: '#/definitions/types.DeleteRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/types.DeleteResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/common.APIError'
      summary: Delete users with optional filtering
      tags:
      - data-management
  /v1/users:upsert:
    post:
      consumes:
      - application/json
      operationId: upsertUsers
      parameters:
      - description: Users upsert
        in: body
        name: payload
        required: true
        schema:
          $ref: '#/definitions/types.UsersUpsertRequest'
      produces:
      - application/json
      responses:
        "202":
          description: Accepted
          schema:
            $ref: '#/definitions/types.Ack'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/common.APIError'
      summary: Upsert users (batch)
      tags:
      - ingestion
schemes:
- https
swagger: "2.0"
