definitions:
  common.APIError:
    properties:
      correlation_id:
        type: string
      details:
        additionalProperties: {}
        type: object
      error:
        type: string
      message:
        type: string
      timestamp:
        type: string
    type: object
  handlers.RecommendationPresetsResponse:
    properties:
      mmr_presets:
        additionalProperties:
          format: float64
          type: number
        type: object
    type: object
  handlers.VersionResponse:
    properties:
      build_time:
        example: "2025-01-15T12:34:56Z"
        type: string
      git_commit:
        example: d34db33f
        type: string
      model_version:
        example: popularity_v1
        type: string
    type: object
  specs_types.ScoredItem:
    properties:
      explain:
        $ref: '#/definitions/types.ExplainBlock'
      item_id:
        example: i_101
        type: string
      reasons:
        items:
          type: string
        type: array
      score:
        example: 0.87
        type: number
    type: object
  specs_types.Segment:
    properties:
      active:
        type: boolean
      created_at:
        type: string
      description:
        type: string
      name:
        type: string
      priority:
        type: integer
      profile_id:
        type: string
      rules:
        items:
          $ref: '#/definitions/specs_types.SegmentRule'
        type: array
      segment_id:
        type: string
      updated_at:
        type: string
    type: object
  specs_types.SegmentProfile:
    properties:
      blend_alpha:
        type: number
      blend_beta:
        type: number
      blend_gamma:
        type: number
      brand_cap:
        type: integer
      brand_tag_prefixes:
        items:
          type: string
        type: array
      category_cap:
        type: integer
      category_tag_prefixes:
        items:
          type: string
        type: array
      co_vis_window_days:
        type: integer
      created_at:
        type: string
      description:
        type: string
      exclude_event_types:
        items:
          type: integer
        type: array
      half_life_days:
        type: number
      mmr_lambda:
        type: number
      popularity_fanout:
        type: integer
      profile_boost:
        type: number
      profile_id:
        type: string
      profile_top_n:
        type: integer
      profile_window_days:
        type: number
      purchased_window_days:
        type: integer
      rule_exclude_events:
        type: boolean
      updated_at:
        type: string
    type: object
  specs_types.SegmentRule:
    properties:
      description:
        type: string
      enabled:
        type: boolean
      rule:
        type: object
      rule_id:
        type: integer
    type: object
  types.Ack:
    properties:
      status:
        type: string
    type: object
  types.AuditDecisionDetail:
    properties:
      bandit:
        $ref: '#/definitions/types.AuditTraceBandit'
      candidates_pre:
        items:
          $ref: '#/definitions/types.AuditTraceCandidate'
        type: array
      caps:
        additionalProperties:
          $ref: '#/definitions/types.AuditTraceCap'
        type: object
      constraints:
        $ref: '#/definitions/types.AuditTraceConstraints'
      decision_id:
        type: string
      effective_config:
        $ref: '#/definitions/types.AuditTraceConfig'
      extras:
        additionalProperties: {}
        type: object
      final_items:
        items:
          $ref: '#/definitions/types.AuditTraceFinalItem'
        type: array
      k:
        type: integer
      mmr_info:
        items:
          $ref: '#/definitions/types.AuditTraceMMR'
        type: array
      namespace:
        type: string
      org_id:
        type: string
      request_id:
        type: string
      surface:
        type: string
      ts:
        type: string
      user_hash:
        type: string
    type: object
  types.AuditDecisionListResponse:
    properties:
      decisions:
        items:
          $ref: '#/definitions/types.AuditDecisionSummary'
        type: array
    type: object
  types.AuditDecisionSummary:
    properties:
      decision_id:
        type: string
      extras:
        additionalProperties: {}
        type: object
      final_items:
        items:
          $ref: '#/definitions/types.AuditTraceFinalItem'
        type: array
      k:
        type: integer
      namespace:
        type: string
      request_id:
        type: string
      surface:
        type: string
      ts:
        type: string
      user_hash:
        type: string
    type: object
  types.AuditDecisionsSearchRequest:
    properties:
      from:
        type: string
      limit:
        type: integer
      namespace:
        type: string
      request_id:
        type: string
      to:
        type: string
      user_hash:
        type: string
    type: object
  types.AuditTraceBandit:
    properties:
      algorithm:
        type: string
      bucket_key:
        type: string
      chosen_policy_id:
        type: string
      experiment:
        type: string
      explain:
        additionalProperties:
          type: string
        type: object
      explore:
        type: boolean
      request_id:
        type: string
      variant:
        type: string
    type: object
  types.AuditTraceCandidate:
    properties:
      item_id:
        type: string
      score:
        type: number
    type: object
  types.AuditTraceCap:
    properties:
      brand:
        $ref: '#/definitions/types.AuditTraceCapUsage'
      category:
        $ref: '#/definitions/types.AuditTraceCapUsage'
    type: object
  types.AuditTraceCapUsage:
    properties:
      applied:
        type: boolean
      count:
        type: integer
      limit:
        type: integer
      value:
        type: string
    type: object
  types.AuditTraceConfig:
    properties:
      alpha:
        type: number
      beta:
        type: number
      brand_cap:
        type: integer
      category_cap:
        type: integer
      co_vis_window_days:
        type: integer
      gamma:
        type: number
      half_life_days:
        type: number
      mmr_lambda:
        type: number
      popularity_fanout:
        type: integer
      profile_boost:
        type: number
      profile_top_n:
        type: integer
      profile_window_days:
        type: number
      purchased_window_days:
        type: integer
      rule_exclude_events:
        type: boolean
    type: object
  types.AuditTraceConstraints:
    properties:
      created_after:
        type: string
      exclude_item_ids:
        items:
          type: string
        type: array
      include_tags_any:
        items:
          type: string
        type: array
      price_between:
        items:
          type: number
        type: array
    type: object
  types.AuditTraceFinalItem:
    properties:
      item_id:
        type: string
      reasons:
        items:
          type: string
        type: array
      score:
        type: number
    type: object
  types.AuditTraceMMR:
    properties:
      brand_cap_hit:
        type: boolean
      category_cap_hit:
        type: boolean
      item_id:
        type: string
      max_sim:
        type: number
      penalty:
        type: number
      pick_index:
        type: integer
      relevance:
        type: number
    type: object
  types.BanditDecideRequest:
    properties:
      algorithm:
        type: string
      candidate_policy_ids:
        items:
          type: string
        type: array
      context:
        additionalProperties:
          type: string
        type: object
      namespace:
        type: string
      request_id:
        type: string
      surface:
        type: string
    type: object
  types.BanditDecideResponse:
    properties:
      algorithm:
        type: string
      bucket_key:
        type: string
      experiment:
        type: string
      explain:
        additionalProperties:
          type: string
        type: object
      explore:
        type: boolean
      policy_id:
        type: string
      surface:
        type: string
      variant:
        type: string
    type: object
  types.BanditExperimentConfig:
    properties:
      enabled:
        type: boolean
      holdout_percent:
        type: number
      label:
        type: string
      surfaces:
        items:
          type: string
        type: array
    type: object
  types.BanditPoliciesUpsertRequest:
    properties:
      namespace:
        type: string
      policies:
        items:
          $ref: '#/definitions/types.BanditPolicy'
        type: array
    type: object
  types.BanditPolicy:
    properties:
      active:
        type: boolean
      blend_alpha:
        type: number
      blend_beta:
        type: number
      blend_gamma:
        type: number
      brand_cap:
        type: integer
      category_cap:
        type: integer
      co_vis_window_days:
        type: integer
      half_life_days:
        type: number
      mmr_lambda:
        type: number
      name:
        type: string
      notes:
        type: string
      policy_id:
        type: string
      popularity_fanout:
        type: integer
      profile_boost:
        type: number
      rule_exclude_events:
        type: boolean
    type: object
  types.BanditRewardRequest:
    properties:
      algorithm:
        type: string
      bucket_key:
        type: string
      experiment:
        type: string
      namespace:
        type: string
      policy_id:
        type: string
      request_id:
        type: string
      reward:
        type: boolean
      surface:
        type: string
      variant:
        type: string
    type: object
  types.DeleteRequest:
    properties:
      created_after:
        description: Date range filters
        example: "2025-01-01T00:00:00Z"
        type: string
      created_before:
        example: "2025-12-31T23:59:59Z"
        type: string
      event_type:
        example: 0
        type: integer
      item_id:
        example: i_123
        type: string
      namespace:
        example: default
        type: string
      user_id:
        description: Optional filters - if not provided, deletes all data in namespace
        example: u_123
        type: string
    type: object
  types.DeleteResponse:
    properties:
      deleted_count:
        type: integer
      message:
        type: string
    type: object
  types.Event:
    properties:
      item_id:
        example: i_123
        type: string
      meta: {}
      source_event_id:
        type: string
      ts:
        example: "2025-09-07T12:34:56Z"
        type: string
      type:
        description: 0=view,1=click,2=add,3=purchase,4=custom
        example: 0
        type: integer
      user_id:
        example: u_123
        type: string
      value:
        example: 1
        type: number
    type: object
  types.EventTypeConfig:
    properties:
      half_life_days:
        type: number
      is_active:
        type: boolean
      name:
        type: string
      type:
        type: integer
      weight:
        type: number
    type: object
  types.EventTypeConfigUpsertRequest:
    properties:
      namespace:
        type: string
      types:
        items:
          $ref: '#/definitions/types.EventTypeConfig'
        type: array
    type: object
  types.EventTypeConfigUpsertResponse:
    properties:
      half_life_days:
        type: number
      is_active:
        type: boolean
      name:
        type: string
      source:
        description: '"tenant" or "default"'
        type: string
      type:
        type: integer
      weight:
        type: number
    type: object
  types.EventsBatchRequest:
    properties:
      events:
        items:
          $ref: '#/definitions/types.Event'
        type: array
      namespace:
        example: default
        type: string
    type: object
  types.ExplainBlend:
    properties:
      alpha:
        type: number
      beta:
        type: number
      contrib:
        $ref: '#/definitions/types.ExplainBlendContribution'
      cooc_norm:
        type: number
      emb_norm:
        type: number
      gamma:
        type: number
      pop_norm:
        type: number
      raw:
        $ref: '#/definitions/types.ExplainBlendRaw'
    type: object
  types.ExplainBlendContribution:
    properties:
      cooc:
        type: number
      emb:
        type: number
      pop:
        type: number
    type: object
  types.ExplainBlendRaw:
    properties:
      cooc:
        type: number
      emb:
        type: number
      pop:
        type: number
    type: object
  types.ExplainBlock:
    properties:
      anchors:
        items:
          type: string
        type: array
      blend:
        $ref: '#/definitions/types.ExplainBlend'
      caps:
        $ref: '#/definitions/types.ExplainCaps'
      mmr:
        $ref: '#/definitions/types.ExplainMMR'
      personalization:
        $ref: '#/definitions/types.ExplainPersonalization'
    type: object
  types.ExplainCapUsage:
    properties:
      applied:
        type: boolean
      count:
        type: integer
      limit:
        type: integer
      value:
        type: string
    type: object
  types.ExplainCaps:
    properties:
      brand:
        $ref: '#/definitions/types.ExplainCapUsage'
      category:
        $ref: '#/definitions/types.ExplainCapUsage'
    type: object
  types.ExplainLLMRequest:
    properties:
      from:
        type: string
      namespace:
        type: string
      question:
        type: string
      segment_id:
        type: string
      surface:
        type: string
      target_id:
        type: string
      target_type:
        type: string
      to:
        type: string
    type: object
  types.ExplainLLMResponse:
    properties:
      cache:
        type: string
      facts:
        additionalProperties: {}
        type: object
      markdown:
        type: string
      model:
        type: string
      warnings:
        items:
          type: string
        type: array
    type: object
  types.ExplainMMR:
    properties:
      lambda:
        type: number
      max_sim:
        type: number
      penalty:
        type: number
      rank:
        type: integer
      relevance:
        type: number
    type: object
  types.ExplainPersonalization:
    properties:
      boost_multiplier:
        type: number
      overlap:
        type: number
      raw:
        $ref: '#/definitions/types.ExplainPersonalizationRaw'
    type: object
  types.ExplainPersonalizationRaw:
    properties:
      profile_boost:
        type: number
    type: object
  types.IDListRequest:
    properties:
      ids:
        items:
          type: string
        type: array
      namespace:
        type: string
    type: object
  types.Item:
    properties:
      available:
        example: true
        type: boolean
      brand:
        example: Acme
        type: string
      category:
        example: Shoes
        type: string
      category_path:
        example:
        - '["Footwear"'
        - '"Running"]'
        items:
          type: string
        type: array
      description:
        type: string
      embedding:
        items:
          type: number
        type: array
      image_url:
        example: https://cdn.example.com/p/sku.jpg
        type: string
      item_id:
        example: i_123
        type: string
      metadata_version:
        example: "2025-10-01"
        type: string
      price:
        example: 19.9
        type: number
      props: {}
      tags:
        items:
          type: string
        type: array
    type: object
  types.ItemsUpsertRequest:
    properties:
      items:
        items:
          $ref: '#/definitions/types.Item'
        type: array
      namespace:
        example: default
        type: string
    type: object
  types.ListResponse:
    properties:
      has_more:
        type: boolean
      items:
        items: {}
        type: array
      limit:
        type: integer
      next_offset:
        type: integer
      offset:
        type: integer
      total:
        type: integer
    type: object
  types.ManualOverrideCancelRequest:
    properties:
      cancelled_by:
        type: string
    type: object
  types.ManualOverrideRequest:
    properties:
      action:
        type: string
      boost_value:
        type: number
      created_by:
        type: string
      expires_at:
        type: string
      item_id:
        type: string
      namespace:
        type: string
      notes:
        type: string
      priority:
        type: integer
      surface:
        type: string
    type: object
  types.ManualOverrideResponse:
    properties:
      action:
        type: string
      boost_value:
        type: number
      cancelled_at:
        type: string
      cancelled_by:
        type: string
      created_at:
        type: string
      created_by:
        type: string
      expires_at:
        type: string
      item_id:
        type: string
      namespace:
        type: string
      notes:
        type: string
      override_id:
        type: string
      rule_id:
        type: string
      status:
        type: string
      surface:
        type: string
    type: object
  types.Overrides:
    properties:
      bandit_algo:
        type: string
      blend_alpha:
        type: number
      blend_beta:
        type: number
      blend_gamma:
        type: number
      brand_cap:
        type: integer
      category_cap:
        type: integer
      covis_window_days:
        type: integer
      mmr_lambda:
        type: number
      popularity_fanout:
        type: integer
      popularity_halflife_days:
        type: integer
      profile_boost:
        type: number
      profile_starter_blend_weight:
        type: number
      profile_top_n:
        type: integer
      profile_window_days:
        type: integer
      purchased_window_days:
        type: integer
      rule_exclude_events:
        type: boolean
    type: object
  types.RecommendBlend:
    properties:
      als:
        example: 0
        type: number
      cooc:
        example: 0.7
        type: number
      pop:
        example: 0.3
        type: number
    type: object
  types.RecommendConstraints:
    properties:
      created_after:
        description: Optional ISO8601 timestamp; only consider events on/after this
          instant.
        example: "2025-06-01T00:00:00Z"
        type: string
      exclude_item_ids:
        description: Exclude these item IDs from results.
        items:
          type: string
        type: array
      include_tags_any:
        description: Match if item.tags overlaps these (any). Empty/omitted = no tag
          filter.
        items:
          type: string
        type: array
      price_between:
        description: 'Optional price bounds: [min, max]. Either end may be omitted.'
        items:
          type: number
        type: array
    type: object
  types.RecommendRequest:
    properties:
      blend:
        $ref: '#/definitions/types.RecommendBlend'
      constraints:
        $ref: '#/definitions/types.RecommendConstraints'
      context:
        additionalProperties: {}
        type: object
      explain_level:
        enum:
        - tags
        - numeric
        - full
        example: numeric
        type: string
      include_reasons:
        example: true
        type: boolean
      k:
        example: 20
        type: integer
      namespace:
        example: default
        type: string
      overrides:
        $ref: '#/definitions/types.Overrides'
      user_id:
        example: u_123
        type: string
    type: object
  types.RecommendResponse:
    properties:
      items:
        items:
          $ref: '#/definitions/specs_types.ScoredItem'
        type: array
      model_version:
        example: pop_2025-09-07_01
        type: string
      profile_id:
        example: vip-high-novelty
        type: string
      segment_id:
        example: vip
        type: string
    type: object
  types.RecommendWithBanditRequest:
    properties:
      algorithm:
        type: string
      blend:
        $ref: '#/definitions/types.RecommendBlend'
      candidate_policy_ids:
        items:
          type: string
        type: array
      constraints:
        $ref: '#/definitions/types.RecommendConstraints'
      context:
        additionalProperties:
          type: string
        type: object
      explain_level:
        enum:
        - tags
        - numeric
        - full
        example: numeric
        type: string
      include_reasons:
        example: true
        type: boolean
      k:
        example: 20
        type: integer
      namespace:
        example: default
        type: string
      overrides:
        $ref: '#/definitions/types.Overrides'
      request_id:
        type: string
      surface:
        type: string
      user_id:
        example: u_123
        type: string
    type: object
  types.RecommendWithBanditResponse:
    properties:
      algorithm:
        type: string
      bandit_bucket:
        type: string
      bandit_experiment:
        type: string
      bandit_explain:
        additionalProperties:
          type: string
        type: object
      bandit_variant:
        type: string
      chosen_policy_id:
        type: string
      explore:
        type: boolean
      items:
        items:
          $ref: '#/definitions/specs_types.ScoredItem'
        type: array
      model_version:
        example: pop_2025-09-07_01
        type: string
      profile_id:
        example: vip-high-novelty
        type: string
      request_id:
        type: string
      segment_id:
        example: vip
        type: string
    type: object
  types.RecommendationConfigDocument:
    properties:
      config:
        $ref: '#/definitions/types.RecommendationConfigPayload'
      metadata:
        $ref: '#/definitions/types.RecommendationConfigMetadata'
      namespace:
        type: string
    type: object
  types.RecommendationConfigMetadata:
    properties:
      notes:
        type: string
      source:
        type: string
      updated_at:
        type: string
      updated_by:
        type: string
    type: object
  types.RecommendationConfigPayload:
    properties:
      bandit_experiment:
        $ref: '#/definitions/types.BanditExperimentConfig'
      blend_alpha:
        type: number
      blend_beta:
        type: number
      blend_gamma:
        type: number
      brand_cap:
        type: integer
      brand_tag_prefixes:
        items:
          type: string
        type: array
      category_cap:
        type: integer
      category_tag_prefixes:
        items:
          type: string
        type: array
      co_vis_window_days:
        type: number
      coverage_cache_ttl_seconds:
        type: number
      coverage_long_tail_hint_threshold:
        type: number
      exclude_event_types:
        items:
          type: integer
        type: array
      half_life_days:
        type: number
      mmr_lambda:
        type: number
      mmr_presets:
        additionalProperties:
          format: float64
          type: number
        type: object
      new_user_blend_alpha:
        type: number
      new_user_blend_beta:
        type: number
      new_user_blend_gamma:
        type: number
      new_user_mmr_lambda:
        type: number
      new_user_pop_fanout:
        type: integer
      popularity_fanout:
        type: integer
      profile_boost:
        type: number
      profile_cold_start_multiplier:
        type: number
      profile_min_events_for_boost:
        type: integer
      profile_starter_blend_weight:
        type: number
      profile_top_n_tags:
        type: integer
      profile_window_days:
        type: number
      purchased_window_days:
        type: number
      rule_exclude_events:
        type: boolean
      rules_enabled:
        type: boolean
    type: object
  types.RecommendationConfigUpdateRequest:
    properties:
      author:
        type: string
      config:
        $ref: '#/definitions/types.RecommendationConfigPayload'
      namespace:
        type: string
      notes:
        type: string
    type: object
  types.RerankCandidate:
    properties:
      item_id:
        example: sku-123
        type: string
      score:
        example: 0.42
        type: number
    type: object
  types.RerankRequest:
    properties:
      blend:
        $ref: '#/definitions/types.RecommendBlend'
      constraints:
        $ref: '#/definitions/types.RecommendConstraints'
      context:
        additionalProperties: {}
        type: object
      explain_level:
        enum:
        - tags
        - numeric
        - full
        example: numeric
        type: string
      include_reasons:
        example: true
        type: boolean
      items:
        items:
          $ref: '#/definitions/types.RerankCandidate'
        type: array
      k:
        example: 20
        type: integer
      namespace:
        example: default
        type: string
      overrides:
        $ref: '#/definitions/types.Overrides'
      user_id:
        example: u_123
        type: string
    type: object
  types.RuleDryRunPinnedItem:
    properties:
      from_candidates:
        type: boolean
      item_id:
        type: string
      rule_ids:
        items:
          type: string
        type: array
    type: object
  types.RuleDryRunRequest:
    properties:
      items:
        items:
          type: string
        type: array
      namespace:
        type: string
      segment_id:
        type: string
      surface:
        type: string
    type: object
  types.RuleDryRunResponse:
    properties:
      pinned_items:
        items:
          $ref: '#/definitions/types.RuleDryRunPinnedItem'
        type: array
      reason_tags:
        additionalProperties:
          items:
            type: string
          type: array
        type: object
      rule_effects_per_item:
        additionalProperties:
          $ref: '#/definitions/types.RuleItemEffectResponse'
        type: object
      rules_evaluated:
        items:
          type: string
        type: array
      rules_matched:
        items:
          $ref: '#/definitions/types.RuleMatchResponse'
        type: array
    type: object
  types.RuleItemEffectResponse:
    properties:
      blocked:
        type: boolean
      boost_delta:
        type: number
      pinned:
        type: boolean
    type: object
  types.RuleMatchResponse:
    properties:
      action:
        type: string
      item_ids:
        items:
          type: string
        type: array
      rule_id:
        type: string
      target_type:
        type: string
    type: object
  types.RulePayload:
    properties:
      action:
        type: string
      boost_value:
        type: number
      description:
        type: string
      enabled:
        type: boolean
      item_ids:
        items:
          type: string
        type: array
      max_pins:
        type: integer
      name:
        type: string
      namespace:
        type: string
      priority:
        type: integer
      segment_id:
        type: string
      surface:
        type: string
      target_key:
        type: string
      target_type:
        type: string
      valid_from:
        type: string
      valid_until:
        type: string
    type: object
  types.RuleResponse:
    properties:
      action:
        type: string
      boost_value:
        type: number
      created_at:
        type: string
      description:
        type: string
      enabled:
        type: boolean
      item_ids:
        items:
          type: string
        type: array
      max_pins:
        type: integer
      name:
        type: string
      namespace:
        type: string
      priority:
        type: integer
      rule_id:
        type: string
      segment_id:
        type: string
      surface:
        type: string
      target_key:
        type: string
      target_type:
        type: string
      updated_at:
        type: string
      valid_from:
        type: string
      valid_until:
        type: string
    type: object
  types.RulesListResponse:
    properties:
      rules:
        items:
          $ref: '#/definitions/types.RuleResponse'
        type: array
    type: object
  types.SegmentDryRunRequest:
    properties:
      context:
        additionalProperties: {}
        type: object
      namespace:
        type: string
      traits:
        additionalProperties: {}
        type: object
      user_id:
        type: string
    type: object
  types.SegmentDryRunResponse:
    properties:
      matched:
        type: boolean
      matched_rule_id:
        type: integer
      profile_id:
        type: string
      segment_id:
        type: string
    type: object
  types.SegmentProfilesListResponse:
    properties:
      namespace:
        type: string
      profiles:
        items:
          $ref: '#/definitions/specs_types.SegmentProfile'
        type: array
    type: object
  types.SegmentProfilesUpsertRequest:
    properties:
      namespace:
        type: string
      profiles:
        items:
          $ref: '#/definitions/specs_types.SegmentProfile'
        type: array
    type: object
  types.SegmentsListResponse:
    properties:
      namespace:
        type: string
      segments:
        items:
          $ref: '#/definitions/specs_types.Segment'
        type: array
    type: object
  types.SegmentsUpsertRequest:
    properties:
      namespace:
        type: string
      segment:
        $ref: '#/definitions/specs_types.Segment'
    type: object
  types.User:
    properties:
      traits: {}
      user_id:
        example: u_123
        type: string
    type: object
  types.UsersUpsertRequest:
    properties:
      namespace:
        example: default
        type: string
      users:
        items:
          $ref: '#/definitions/types.User'
        type: array
    type: object
info:
  contact: {}
paths:
  /v1/admin/manual_overrides:
    get:
      parameters:
      - description: Namespace
        in: query
        name: namespace
        required: true
        type: string
      - description: Surface
        in: query
        name: surface
        type: string
      - description: Filter by status (active,cancelled,expired)
        in: query
        name: status
        type: string
      - description: Filter by action (boost,suppress)
        in: query
        name: action
        type: string
      - description: Include expired overrides
        in: query
        name: include_expired
        type: boolean
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/types.ManualOverrideResponse'
            type: array
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/common.APIError'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/common.APIError'
      summary: List manual overrides
      tags:
      - admin
    post:
      consumes:
      - application/json
      parameters:
      - description: Manual override payload
        in: body
        name: payload
        required: true
        schema:
          $ref: '#/definitions/types.ManualOverrideRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/types.ManualOverrideResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/common.APIError'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/common.APIError'
      summary: Create a manual boost/suppression override
      tags:
      - admin
  /v1/admin/manual_overrides/{override_id}/cancel:
    post:
      consumes:
      - application/json
      parameters:
      - description: Override ID
        in: path
        name: override_id
        required: true
        type: string
      - description: Optional cancellation metadata
        in: body
        name: payload
        schema:
          $ref: '#/definitions/types.ManualOverrideCancelRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/types.ManualOverrideResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/common.APIError'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/common.APIError'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/common.APIError'
      summary: Cancel a manual override
      tags:
      - admin
  /v1/admin/recommendation/config:
    get:
      parameters:
      - default: default
        description: Namespace
        in: query
        name: namespace
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/types.RecommendationConfigDocument'
      summary: Fetch the active recommendation config snapshot
      tags:
      - admin
    post:
      consumes:
      - application/json
      parameters:
      - description: Updated config
        in: body
        name: payload
        required: true
        schema:
          $ref: '#/definitions/types.RecommendationConfigUpdateRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/types.RecommendationConfigDocument'
      summary: Update the active recommendation config
      tags:
      - admin
  /v1/admin/recommendation/presets:
    get:
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/handlers.RecommendationPresetsResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/common.APIError'
      summary: List recommendation presets
      tags:
      - recommendation
  /v1/admin/rules:
    get:
      consumes:
      - application/json
      description: List merchandising rules with optional filtering
      parameters:
      - description: Namespace
        in: query
        name: namespace
        required: true
        type: string
      - description: Filter by surface
        in: query
        name: surface
        type: string
      - description: Filter by segment ID
        in: query
        name: segment_id
        type: string
      - description: Filter by enabled status
        in: query
        name: enabled
        type: boolean
      - description: Filter by active status
        in: query
        name: active_now
        type: boolean
      - description: Filter by action type
        in: query
        name: action
        type: string
      - description: Filter by target type
        in: query
        name: target_type
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/types.RulesListResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/common.APIError'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/common.APIError'
      summary: List merchandising rules
      tags:
      - admin
    post:
      consumes:
      - application/json
      description: Create a new merchandising rule (BLOCK, PIN, BOOST)
      parameters:
      - description: Rule payload
        in: body
        name: payload
        required: true
        schema:
          $ref: '#/definitions/types.RulePayload'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/types.RuleResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/common.APIError'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/common.APIError'
      summary: Create a merchandising rule
      tags:
      - admin
  /v1/admin/rules/{rule_id}:
    put:
      consumes:
      - application/json
      description: Update an existing merchandising rule
      parameters:
      - description: Rule ID
        in: path
        name: rule_id
        required: true
        type: string
      - description: Rule payload
        in: body
        name: payload
        required: true
        schema:
          $ref: '#/definitions/types.RulePayload'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/types.RuleResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/common.APIError'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/common.APIError'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/common.APIError'
      summary: Update a merchandising rule
      tags:
      - admin
  /v1/admin/rules/dry-run:
    post:
      consumes:
      - application/json
      description: Preview matched rules and effects without mutating state
      parameters:
      - description: Dry run request
        in: body
        name: payload
        required: true
        schema:
          $ref: '#/definitions/types.RuleDryRunRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/types.RuleDryRunResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/common.APIError'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/common.APIError'
      summary: Preview rule effects
      tags:
      - admin
  /v1/audit/decisions:
    get:
      parameters:
      - description: Namespace
        in: query
        name: namespace
        required: true
        type: string
      - description: From timestamp (RFC3339)
        in: query
        name: from
        type: string
      - description: To timestamp (RFC3339)
        in: query
        name: to
        type: string
      - description: User hash
        in: query
        name: user_hash
        type: string
      - description: Request ID
        in: query
        name: request_id
        type: string
      - description: Limit
        in: query
        name: limit
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/types.AuditDecisionListResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/common.APIError'
      summary: List decision traces with optional filters
      tags:
      - audit
  /v1/audit/decisions/{decision_id}:
    get:
      parameters:
      - description: Decision ID
        in: path
        name: decision_id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/types.AuditDecisionDetail'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/common.APIError'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/common.APIError'
      summary: Get full decision trace by ID
      tags:
      - audit
  /v1/audit/search:
    post:
      consumes:
      - application/json
      parameters:
      - description: Search request
        in: body
        name: payload
        required: true
        schema:
          $ref: '#/definitions/types.AuditDecisionsSearchRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/types.AuditDecisionListResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/common.APIError'
      summary: Search decision traces with advanced filters
      tags:
      - audit
  /v1/bandit/decide:
    post:
      consumes:
      - application/json
      parameters:
      - description: Decision request
        in: body
        name: payload
        required: true
        schema:
          $ref: '#/definitions/types.BanditDecideRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/types.BanditDecideResponse'
      summary: Decide best policy for this request context
      tags:
      - bandit
  /v1/bandit/policies:
    get:
      parameters:
      - description: Namespace
        in: query
        name: namespace
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/types.BanditPolicy'
            type: array
      summary: List all bandit policies (active and inactive)
      tags:
      - bandit
  /v1/bandit/policies:upsert:
    post:
      consumes:
      - application/json
      operationId: upsertBanditPolicies
      parameters:
      - description: Policies
        in: body
        name: payload
        required: true
        schema:
          $ref: '#/definitions/types.BanditPoliciesUpsertRequest'
      produces:
      - application/json
      responses:
        "202":
          description: Accepted
          schema:
            $ref: '#/definitions/types.Ack'
      summary: Upsert bandit policies
      tags:
      - bandit
  /v1/bandit/recommendations:
    post:
      consumes:
      - application/json
      parameters:
      - description: Request
        in: body
        name: payload
        required: true
        schema:
          $ref: '#/definitions/types.RecommendWithBanditRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/types.RecommendWithBanditResponse'
      summary: Recommend with bandit-selected policy
      tags:
      - ranking
  /v1/bandit/reward:
    post:
      consumes:
      - application/json
      parameters:
      - description: Reward request
        in: body
        name: payload
        required: true
        schema:
          $ref: '#/definitions/types.BanditRewardRequest'
      produces:
      - application/json
      responses:
        "202":
          description: Accepted
          schema:
            $ref: '#/definitions/types.Ack'
      summary: Report binary reward for a previous decision
      tags:
      - bandit
  /v1/event-types:
    get:
      parameters:
      - description: Namespace
        in: query
        name: namespace
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/types.EventTypeConfigUpsertResponse'
            type: array
      summary: List effective event-type config
      tags:
      - config
  /v1/event-types:upsert:
    post:
      consumes:
      - application/json
      operationId: upsertEventTypes
      parameters:
      - description: Event types
        in: body
        name: payload
        required: true
        schema:
          $ref: '#/definitions/types.EventTypeConfigUpsertRequest'
      produces:
      - application/json
      responses:
        "202":
          description: Accepted
          schema:
            $ref: '#/definitions/types.Ack'
      summary: Upsert tenant event-type config
      tags:
      - config
  /v1/events:
    get:
      consumes:
      - application/json
      description: Get a paginated list of events with optional filtering by user_id,
        item_id, event_type, date range, etc.
      operationId: listEvents
      parameters:
      - description: Namespace
        in: query
        name: namespace
        required: true
        type: string
      - description: 'Limit (default: 100, max: 1000)'
        in: query
        name: limit
        type: integer
      - description: 'Offset (default: 0)'
        in: query
        name: offset
        type: integer
      - description: Filter by user ID
        in: query
        name: user_id
        type: string
      - description: Filter by item ID
        in: query
        name: item_id
        type: string
      - description: Filter by event type
        in: query
        name: event_type
        type: integer
      - description: Filter by creation date (ISO8601)
        in: query
        name: created_after
        type: string
      - description: Filter by creation date (ISO8601)
        in: query
        name: created_before
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/types.ListResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/common.APIError'
      summary: List events with pagination and filtering
      tags:
      - data-management
  /v1/events:batch:
    post:
      consumes:
      - application/json
      operationId: batchEvents
      parameters:
      - description: Events batch
        in: body
        name: payload
        required: true
        schema:
          $ref: '#/definitions/types.EventsBatchRequest'
      produces:
      - application/json
      responses:
        "202":
          description: Accepted
          schema:
            $ref: '#/definitions/types.Ack'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/common.APIError'
      summary: Ingest events (batch)
      tags:
      - ingestion
  /v1/events:delete:
    post:
      consumes:
      - application/json
      description: Delete events based on filters. If no filters provided, deletes
        all events in namespace.
      operationId: deleteEvents
      parameters:
      - description: Delete request
        in: body
        name: payload
        required: true
        schema:
          $ref: '#/definitions/types.DeleteRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/types.DeleteResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/common.APIError'
      summary: Delete events with optional filtering
      tags:
      - data-management
  /v1/explain/llm:
    post:
      consumes:
      - application/json
      parameters:
      - description: Explain request
        in: body
        name: payload
        required: true
        schema:
          $ref: '#/definitions/types.ExplainLLMRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/types.ExplainLLMResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/common.APIError'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/common.APIError'
      summary: Generate RCA explanation via LLM
      tags:
      - explain
  /v1/items:
    get:
      consumes:
      - application/json
      description: Get a paginated list of items with optional filtering by item_id,
        date range, etc.
      operationId: listItems
      parameters:
      - description: Namespace
        in: query
        name: namespace
        required: true
        type: string
      - description: 'Limit (default: 100, max: 1000)'
        in: query
        name: limit
        type: integer
      - description: 'Offset (default: 0)'
        in: query
        name: offset
        type: integer
      - description: Filter by item ID
        in: query
        name: item_id
        type: string
      - description: Filter by creation date (ISO8601)
        in: query
        name: created_after
        type: string
      - description: Filter by creation date (ISO8601)
        in: query
        name: created_before
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/types.ListResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/common.APIError'
      summary: List items with pagination and filtering
      tags:
      - data-management
  /v1/items/{item_id}/similar:
    get:
      parameters:
      - description: Item ID
        in: path
        name: item_id
        required: true
        type: string
      - default: default
        description: Namespace
        in: query
        name: namespace
        type: string
      - default: 20
        description: Top-K
        in: query
        name: k
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/specs_types.ScoredItem'
            type: array
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/common.APIError'
      summary: Get similar items
      tags:
      - ranking
  /v1/items:delete:
    post:
      consumes:
      - application/json
      description: Delete items based on filters. If no filters provided, deletes
        all items in namespace.
      operationId: deleteItems
      parameters:
      - description: Delete request
        in: body
        name: payload
        required: true
        schema:
          $ref: '#/definitions/types.DeleteRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/types.DeleteResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/common.APIError'
      summary: Delete items with optional filtering
      tags:
      - data-management
  /v1/items:upsert:
    post:
      consumes:
      - application/json
      description: Create or update items by opaque IDs.
      operationId: upsertItems
      parameters:
      - description: Items upsert
        in: body
        name: payload
        required: true
        schema:
          $ref: '#/definitions/types.ItemsUpsertRequest'
      produces:
      - application/json
      responses:
        "202":
          description: Accepted
          schema:
            $ref: '#/definitions/types.Ack'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/common.APIError'
      summary: Upsert items (batch)
      tags:
      - ingestion
  /v1/recommendations:
    post:
      consumes:
      - application/json
      parameters:
      - description: Recommend request
        in: body
        name: payload
        required: true
        schema:
          $ref: '#/definitions/types.RecommendRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/types.RecommendResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/common.APIError'
      summary: Get recommendations for a user
      tags:
      - ranking
  /v1/rerank:
    post:
      consumes:
      - application/json
      parameters:
      - description: Rerank request
        in: body
        name: payload
        required: true
        schema:
          $ref: '#/definitions/types.RerankRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/types.RecommendResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/common.APIError'
      summary: Rerank a candidate set
      tags:
      - ranking
  /v1/segment-profiles:
    get:
      parameters:
      - default: default
        description: Namespace
        in: query
        name: namespace
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/types.SegmentProfilesListResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/common.APIError'
      summary: List segment profiles
      tags:
      - config
  /v1/segment-profiles:delete:
    post:
      consumes:
      - application/json
      operationId: segmentProfilesDelete
      parameters:
      - description: IDs
        in: body
        name: payload
        required: true
        schema:
          $ref: '#/definitions/types.IDListRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/types.Ack'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/common.APIError'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/common.APIError'
      summary: Delete segment profiles
      tags:
      - config
  /v1/segment-profiles:upsert:
    post:
      consumes:
      - application/json
      operationId: segmentProfilesUpsert
      parameters:
      - description: Profiles
        in: body
        name: payload
        required: true
        schema:
          $ref: '#/definitions/types.SegmentProfilesUpsertRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/types.Ack'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/common.APIError'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/common.APIError'
      summary: Upsert segment profiles
      tags:
      - config
  /v1/segments:
    get:
      parameters:
      - default: default
        description: Namespace
        in: query
        name: namespace
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/types.SegmentsListResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/common.APIError'
      summary: List segments with rules
      tags:
      - config
  /v1/segments:delete:
    post:
      consumes:
      - application/json
      operationId: segmentsDelete
      parameters:
      - description: IDs
        in: body
        name: payload
        required: true
        schema:
          $ref: '#/definitions/types.IDListRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/types.Ack'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/common.APIError'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/common.APIError'
      summary: Delete segments
      tags:
      - config
  /v1/segments:dry-run:
    post:
      consumes:
      - application/json
      operationId: segmentsDryRun
      parameters:
      - description: Dry run
        in: body
        name: payload
        required: true
        schema:
          $ref: '#/definitions/types.SegmentDryRunRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/types.SegmentDryRunResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/common.APIError'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/common.APIError'
      summary: Simulate segment selection for context
      tags:
      - config
  /v1/segments:upsert:
    post:
      consumes:
      - application/json
      operationId: segmentsUpsert
      parameters:
      - description: Segment
        in: body
        name: payload
        required: true
        schema:
          $ref: '#/definitions/types.SegmentsUpsertRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/types.Ack'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/common.APIError'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/common.APIError'
      summary: Upsert a segment and its rules
      tags:
      - config
  /v1/users:
    get:
      consumes:
      - application/json
      description: Get a paginated list of users with optional filtering by user_id,
        date range, etc.
      operationId: listUsers
      parameters:
      - description: Namespace
        in: query
        name: namespace
        required: true
        type: string
      - description: 'Limit (default: 100, max: 1000)'
        in: query
        name: limit
        type: integer
      - description: 'Offset (default: 0)'
        in: query
        name: offset
        type: integer
      - description: Filter by user ID
        in: query
        name: user_id
        type: string
      - description: Filter by creation date (ISO8601)
        in: query
        name: created_after
        type: string
      - description: Filter by creation date (ISO8601)
        in: query
        name: created_before
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/types.ListResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/common.APIError'
      summary: List users with pagination and filtering
      tags:
      - data-management
  /v1/users:delete:
    post:
      consumes:
      - application/json
      description: Delete users based on filters. If no filters provided, deletes
        all users in namespace.
      operationId: deleteUsers
      parameters:
      - description: Delete request
        in: body
        name: payload
        required: true
        schema:
          $ref: '#/definitions/types.DeleteRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/types.DeleteResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/common.APIError'
      summary: Delete users with optional filtering
      tags:
      - data-management
  /v1/users:upsert:
    post:
      consumes:
      - application/json
      operationId: upsertUsers
      parameters:
      - description: Users upsert
        in: body
        name: payload
        required: true
        schema:
          $ref: '#/definitions/types.UsersUpsertRequest'
      produces:
      - application/json
      responses:
        "202":
          description: Accepted
          schema:
            $ref: '#/definitions/types.Ack'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/common.APIError'
      summary: Upsert users (batch)
      tags:
      - ingestion
  /version:
    get:
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/handlers.VersionResponse'
      summary: Describe the running build
      tags:
      - meta
swagger: "2.0"
